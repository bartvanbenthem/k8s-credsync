apiVersion: v1
kind: Secret
metadata:
  name: ldap-toml
  namespace: co-monitoring
  labels:
    app: ldap-toml
stringData:
  ldap.toml: |
    verbose_logging = true
    [[servers]]
    host = "k8.test.nl"
    port = 389
    use_ssl = false
    start_tls = false
    ssl_skip_verify = false 
    bind_dn = "cn=srvck8s-test@k8test.nl,ou=Service Accounts,ou=k8test.nl,ou=Hosting,dc=k8,dc=test,dc=nl"
    bind_password = '2343534543554'
    search_filter = "(userPrincipalName=%s)"
    search_base_dns = ["ou=k8test.nl,ou=Hosting,dc=k8,dc=test,dc=nl"]
    [servers.attributes]
    name = "givenName"
    surname = "sn"
    username = "userPrincipalName"
    member_of = "memberOf"
    email =  "email"
    [[servers.group_mappings]]
    group_dn = "cn=k8s admins,ou=Groups,ou=k8test.nl,OU=Hosting,dc=k8,dc=test,dc=nl"
    org_id = 1
    org_role = "Admin"
    grafana_admin = true

    [[servers.group_mappings]]
    group_dn = "cn=team alpha-dev,ou=Groups,ou=k8test.nl,OU=Hosting,dc=k8,dc=test,dc=nl"
    org_id = 3
    org_role = "Admin"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-ldap-groups
  namespace: co-monitoring
data:
  team-alpha-dev: "cn=team alpha-dev,ou=Groups,ou=k8test.nl,ou=Hosting,dc=k8,dc=test,dc=nl"
  team-beta-test: "cn=team beta-test,ou=Groups,ou=k8test.nl,ou=Hosting,dc=k8,dc=test,dc=nl"
  team-charlie-test: "cn=team charlie-test,ou=Groups,ou=k8test.nl,ou=Hosting,dc=k8,dc=test,dc=nl"